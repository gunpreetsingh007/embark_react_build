"use strict";(self.webpackChunkembark_react=self.webpackChunkembark_react||[]).push([[9913],{65238:function(e,t,s){s.d(t,{Z:function(){return o}});var r=s(55294);var n=class{constructor(e){this._initializeResponseInterceptor=()=>{this.instance.interceptors.response.use(this._handleResponse,this._handleError)},this._handleResponse=e=>e,this._handleError=async e=>{let{response:t,config:s}=e;return Promise.resolve(t)},this.instance=r.Z.create({baseURL:e}),this._initializeResponseInterceptor()}},a=s(69441);class o extends n{constructor(){super("https://embarkperfumes.com/api"),this._initializeRequestInterceptor=()=>{this.instance.interceptors.request.use(this._handleRequest)},this._handleRequest=async e=>{let t=a.Z.getState().user.currentUser.accessToken;return t&&(e.headers.Authorization=t),sessionStorage.getItem("session-id")&&(e.headers["session-id"]=sessionStorage.getItem("session-id")),e},this._initializeRequestInterceptor()}callApi(e,t){return this.instance({method:t.method,url:e,headers:null!==t&&void 0!==t&&t.header?null===t||void 0===t?void 0:t.header:{},data:null!==t&&void 0!==t&&t.body?null===t||void 0===t?void 0:t.body:void 0,onUploadProgress:null!==t&&void 0!==t&&t.onUploadProgress?null===t||void 0===t?void 0:t.onUploadProgress:void 0})}}},89404:function(e,t,s){const r=new(s(65238).Z);t.Z=e=>{if(sessionStorage.getItem("session-id")&&(t=sessionStorage.getItem("session-id"),/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[4][0-9a-fA-F]{3}-[89ABab][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$/.test(t)))r.callApi("/session/trackUserEvent",{method:"POST",body:{event:e}});else{sessionStorage.removeItem("session-id");const t=function(e){const t=new URLSearchParams(window.location.search),s={};for(const[r,n]of t)r.includes(e)&&(s[r]=n);return s}("utm");let s={method:"POST",body:{additionalDetails:t,event:e}};r.callApi("/session/createNewSession",s).then((e=>{sessionStorage.setItem("session-id",e.data.data)}))}var t}},67604:function(e,t,s){var r=s(21830),n=s.n(r),a=s(58086),o=s.n(a),i=s(80184);const l=o()(n());t.Z=async(e,t,s)=>l.fire({title:(0,i.jsx)("strong",{children:e}),html:(0,i.jsx)("p",{children:t}),icon:s})},9913:function(e,t,s){s.r(t),s.d(t,{default:function(){return f}});var r=s(72791);const n=e=>{const{emailOrPhone:t,password:s}=e;var r={emailOrPhone:!1,password:!1,message:""};return t||(r.emailOrPhone=!0),(t&&isNaN(t)&&!/\S+@\S+\.\S+/.test(t)||!isNaN(t)&&10!=t.length)&&(r.emailOrPhone=!0,r.message="invalid emailOrPhone"),s||(r.password=!0),r};var a=s(57689),o=s(11087),i=s(46799),l=s(65238),c=s(59434),d=s(72881),h=s(67604),m=s(30456),u=s(89404),p=s(80184);const g=new l.Z;var f=function(){const e=(0,a.s0)(),t=(0,c.I0)(),[s,l]=(0,o.lr)(),[f,w]=(0,r.useState)(s.get("target")||null),[v,b]=(0,r.useState)(!1),[N,x]=(0,r.useState)({emailOrPhone:!1,password:!1,message:""}),[S,y]=(0,r.useState)({emailOrPhone:"",password:""}),I=(e,t)=>{y({...S,[t]:e}),!0!==N.emailOrPhone&&!0!==N.password||x({...N,[t]:!1})},k=window.google,P=async s=>{const r={method:"POST",body:(0,m.Z)(s.credential)};try{b(!0);const s=await g.callApi("auth/loginWithGoogle",r);200==s.status?(b(!1),t((0,i.x4)({userId:s.data.id,accessToken:s.data.accessToken,role:s.data.role,firstName:s.data.firstName,lastName:s.data.lastName,email:s.data.email,contact:s.data.phoneNumber})),e("checkout"==f?"/checkout":"/")):(b(!1),(0,h.Z)("Error",s.data.errorMessage||"Something went wrong","error"))}catch(N){console.error("Something went wrong")}};return(0,r.useEffect)((()=>{k.accounts.id.initialize({client_id:"565815563901-1aifse56er87bilok6i98r9p5h8pnhsu.apps.googleusercontent.com",callback:P}),k.accounts.id.renderButton(document.getElementById("SignInWithGoogle"),{theme:"outline",size:"large"})}),[]),(0,r.useEffect)((()=>{(0,u.Z)("Sign In")}),[]),(0,p.jsxs)(p.Fragment,{children:[v?(0,p.jsx)(d.Z,{}):null,(0,p.jsx)("div",{className:"signIn-wrapper bg-dark d-flex align-item-center justify-content-center w-100",children:(0,p.jsxs)("div",{className:"signIn",children:[(0,p.jsx)("h2",{className:"mb-3",children:"Sign In"}),(0,p.jsxs)("form",{children:[(0,p.jsxs)("div",{className:"form-group mb-2",children:[(0,p.jsx)("label",{htmlFor:"emailOrPhone",className:"form-label",children:"Email Address or Phone Number"}),(0,p.jsx)("input",{id:"emailOrPhone",className:"form-control ".concat(N.emailOrPhone&&"errorInputField"),required:!0,onChange:e=>I(e.target.value,"emailOrPhone")}),N.emailOrPhone&&(0,p.jsx)("div",{className:"error",children:N.message?"Please enter a valid email or phone number ":"Please enter your email or phone number"})]}),(0,p.jsxs)("div",{className:"form-group mb-2",children:[(0,p.jsx)("label",{htmlFor:"password",className:"form-label",children:"Password"}),(0,p.jsx)("input",{type:"password",id:"password",className:"form-control ".concat(N.password&&"errorInputField"),required:!0,onChange:e=>I(e.target.value,"password")}),N.password&&(0,p.jsx)("div",{className:"error",children:"Please enter your password"}),(0,p.jsx)("div",{className:"forget-password mt-2",children:(0,p.jsx)(o.rU,{to:"/forget-password",children:(0,p.jsx)("span",{children:"Forgot Password?"})})})]}),(0,p.jsx)("button",{className:"btn btn-dark w-100 mt-2",onClick:s=>(async s=>{try{s.preventDefault();const r=n(S);if(x(r),r.emailOrPhone||r.password)return;const a={method:"POST",body:S};b(!0);const o=await g.callApi("auth/login",a);200==o.status?(b(!1),t((0,i.x4)({userId:o.data.id,accessToken:o.data.accessToken,role:o.data.role,firstName:o.data.firstName,lastName:o.data.lastName,email:o.data.email,contact:o.data.phoneNumber})),e("checkout"==f?"/checkout":"cart"==f?"/cart":"/")):(b(!1),(0,h.Z)("Error",o.data.errorMessage||"Something went wrong","error"))}catch(N){console.error("Something went wrong")}})(s),children:"SIGN IN"}),(0,p.jsx)("div",{className:"text-center mt-2",children:(0,p.jsxs)("p",{children:["Not a member? ",(0,p.jsx)(o.rU,{to:"/sign-up",children:"Register"})]})}),(0,p.jsx)("span",{style:{display:"block",textAlign:"center",margin:"0.7rem 0"},children:" OR  "}),(0,p.jsx)("div",{id:"SignInWithGoogle",style:{display:"flex",justifyContent:"center"}})]})]})})]})}},30456:function(e,t,s){function r(e){this.message=e}r.prototype=new Error,r.prototype.name="InvalidCharacterError";var n="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new r("'atob' failed: The string to be decoded is not correctly encoded.");for(var s,n,a=0,o=0,i="";n=t.charAt(o++);~n&&(s=a%4?64*s+n:n,a++%4)?i+=String.fromCharCode(255&s>>(-2*a&6)):0)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return i};function a(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(n(e).replace(/(.)/g,(function(e,t){var s=t.charCodeAt(0).toString(16).toUpperCase();return s.length<2&&(s="0"+s),"%"+s})))}(t)}catch(e){return n(t)}}function o(e){this.message=e}o.prototype=new Error,o.prototype.name="InvalidTokenError",t.Z=function(e,t){if("string"!=typeof e)throw new o("Invalid token specified");var s=!0===(t=t||{}).header?0:1;try{return JSON.parse(a(e.split(".")[s]))}catch(e){throw new o("Invalid token specified: "+e.message)}}}}]);
//# sourceMappingURL=9913.8f6d9d72.chunk.js.map