"use strict";(self.webpackChunkembark_react=self.webpackChunkembark_react||[]).push([[7905],{37905:function(e,t,r){r.r(t);var n=r(74165),a=r(15861),u=r(93433),i=r(29439),o=r(65238),s=r(47701),l=r(48672),c=r(87315),d=r(78820),p=r(84373),m=r(24373),f=r(72791),g=r(72881),v=r(57689),h=r(7273),b=r(67604),x=r(80184),Z=new o.Z;t.default=function(e){var t,r,o,j,N,y,P,k=(0,f.useState)(!1),w=(0,i.Z)(k,2),E=w[0],I=w[1],F=(0,f.useState)({image:{}}),S=(0,i.Z)(F,2),A=S[0],C=S[1],U=(0,v.s0)(),O=(0,v.UO)().id,M=(0,f.useState)([]),T=(0,i.Z)(M,2),q=T[0],V=T[1],D=(0,f.useRef)(),J=(0,f.useState)([{productName:"",attributeValue:"",count:"",pictureUrl:"",productMainImageProgress:0,refNumber:"",hsnNumber:""}]),L=(0,i.Z)(J,2),R=L[0],B=L[1],G=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var r,a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=R[t],a=[],r.pictureUrl&&a.push(_(r.pictureUrl)),e.next=5,Promise.all(a);case 5:R.splice(t,1),B((0,u.Z)(R));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(e){var t=e.split("/"),r={method:"DELETE",body:{name:t[t.length-1]}};return Z.callApi("/file/deleteFile",r)},H=(0,f.useCallback)((0,a.Z)((0,n.Z)().mark((function e(){var t,r,a,u,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return I(!0),t={method:"GET"},e.next=4,Z.callApi("/popup/getPopupById/".concat(O||""),t);case 4:200==(null===(r=e.sent)||void 0===r?void 0:r.status)&&(r.data.data.image.progress=100,A=r.data.data,C(r.data.data),i=null===r||void 0===r||null===(a=r.data)||void 0===a||null===(u=a.data)||void 0===u?void 0:u.products.map((function(e){return e.productMainImageProgress=100,e.attributeValue=Object.values(e.attributeCombination)[0],e})),B(i),I(!1));case 6:case"end":return e.stop()}}),e)}))),[]);(0,f.useEffect)((function(){"edit"==e.type&&H(),K()}),[]);var X=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var r,a,u,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new FormData).append("productImage",t),a={method:"POST",headers:{"Content-Type":"multipart/form-data"},body:r,onUploadProgress:function(e){A.image.progress=Math.round(100*e.loaded/e.total),C(JSON.parse(JSON.stringify(A)))}},e.next=5,Z.callApi("/file/uploadFile",a);case 5:200==(u=e.sent).status?(A.image.url=null===u||void 0===u||null===(i=u.data)||void 0===i?void 0:i.data,C(JSON.parse(JSON.stringify(A)))):(A.image.progress=-1,C(JSON.parse(JSON.stringify(A))));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){var t,r,a,u,i,o,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return I(!0),a=null===(t=A)||void 0===t||null===(r=t.image)||void 0===r?void 0:r.url,u=a.split("/"),i=u[u.length-1],o={method:"DELETE",body:{name:i}},e.next=7,Z.callApi("/file/deleteFile",o);case 7:if(200!==(null===(s=e.sent)||void 0===s?void 0:s.status)){e.next=16;break}return I(!1),A.image.url="",A.image.progress=0,C(JSON.parse(JSON.stringify(A))),e.abrupt("return","success");case 16:return I(!1),e.abrupt("return","failed");case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),K=(0,f.useCallback)((0,a.Z)((0,n.Z)().mark((function e(){var t,r,a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"GET"},e.next=3,Z.callApi("/addProduct/chooseProductAttributes",t);case 3:200==(null===(r=e.sent)||void 0===r?void 0:r.status)&&V(null===r||void 0===r||null===(a=r.data)||void 0===a?void 0:a.data.map((function(e){return{value:e.id,label:e.attributeName}})));case 5:case"end":return e.stop()}}),e)}))),[]),Q=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t,r){var a,i,o,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=new FormData).append("productImage",t),i={method:"POST",headers:{"Content-Type":"multipart/form-data"},body:a,onUploadProgress:function(e){R[r].productMainImageProgress=Math.round(100*e.loaded/e.total),B((0,u.Z)(R))}},e.next=5,Z.callApi("/file/uploadFile",i);case 5:200==(o=e.sent).status?(R[r].pictureUrl=null===o||void 0===o||null===(s=o.data)||void 0===s?void 0:s.data,B((0,u.Z)(R))):(R[r].productMainImageProgress=-1,B((0,u.Z)(R)));case 7:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),W=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var r,a,i,o,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return I(!0),r=R[t].pictureUrl,a=r.split("/"),i=a[a.length-1],o={method:"DELETE",body:{name:i}},e.next=7,Z.callApi("/file/deleteFile",o);case 7:if(200!==(null===(s=e.sent)||void 0===s?void 0:s.status)){e.next=16;break}return I(!1),R[t].pictureUrl="",R[t].productMainImageProgress=0,B((0,u.Z)(R)),e.abrupt("return","success");case 16:return I(!1),e.abrupt("return","failed");case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=function(){var t=(0,a.Z)((0,n.Z)().mark((function t(r){var a,u,i,o,s,l,c,d,p;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(I(!0),a=r.minimumAmount,u={minimumAmount:a,image:{url:A.image.url}},i=[],o=0;o<R.length;o++)(s={}).refNumber=r["refNumber".concat(o)],s.hsnNumber=r["hsnNumber".concat(o)],s.productName=r["productName".concat(o)],s.count=r["count".concat(o)],s.pictureUrl=R[o].pictureUrl,s.attributeCombination={},s.attributeCombination[r["attribute".concat(o)]]=r["attributeValue".concat(o)],i.push(s);return u.products=i,"edit"==e.type&&(u.id=A.id),l={method:"edit"==e.type?"PUT":"POST",body:u},c="edit"==e.type?"/popup/updatePopup":"/popup/createPopup",t.next=11,Z.callApi(c,l);case 11:200===(null===(d=t.sent)||void 0===d?void 0:d.status)?(p="edit"==e.type?"Updated successfully":"Popup successfully created",(0,b.Z)("Success",p,"success"),I(!1)):((0,b.Z)("Error","Something went wrong","error"),I(!1)),U("/manage-popups");case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return(0,x.jsxs)(x.Fragment,{children:[E?(0,x.jsx)(g.Z,{}):null,(0,x.jsx)("div",{className:"container-fluid addEditProductContainer my-lg-5",children:(0,x.jsxs)(s.Z,{onSubmit:Y,ref:D,children:[(0,x.jsxs)(c.X2,{children:[(0,x.jsx)(c.sg,{md:12,children:(0,x.jsx)(m.Z,{name:"minimumAmount",label:"Minimum Amount",required:!0,isFormInputElement:!0,value:null===(t=A)||void 0===t?void 0:t.minimumAmount})}),(0,x.jsx)(c.sg,{md:12,children:(0,x.jsx)(l.Z,{name:"image",label:"Popup Image",isFormInputElement:!0,required:!0,acceptedFormat:"image/png, image/jpeg, image/jpg",onChange:function(e){return X(e)},value:null!==(r=A)&&void 0!==r&&null!==(o=r.image)&&void 0!==o&&o.url?"http://localhost:8085/api/"+(null===(j=A)||void 0===j||null===(N=j.image)||void 0===N?void 0:N.url):"",deleteFile:z,progress:null===(y=A)||void 0===y||null===(P=y.image)||void 0===P?void 0:P.progress})}),(0,x.jsxs)(c.sg,{md:12,children:[(0,x.jsx)(c.Dx,{children:"Add Products"}),R.map((function(e,t){return(0,x.jsxs)("div",{children:[(0,x.jsx)(c.sg,{md:12,children:(0,x.jsxs)("div",{className:"form-title",children:[(0,x.jsxs)("p",{children:["Product ",t+1," Details"]}),t?(0,x.jsxs)("p",{onClick:function(){return G(t)},children:[(0,x.jsx)(d.SV5,{}),"Delete Product ",t+1]}):null]})}),(0,x.jsx)(c.sg,{md:6,children:(0,x.jsx)(m.Z,{name:"productName".concat(t),label:"Product Name",value:e.productName,required:!0,isFormInputElement:!0})}),(0,x.jsx)(c.sg,{md:6,children:(0,x.jsx)(h.Z,{name:"attribute".concat(t),label:"Choose Attribute",required:!0,isFormInputElement:!0,value:Object.keys((null===e||void 0===e?void 0:e.attributeCombination)||{})[0],data:q})}),(0,x.jsx)(c.sg,{md:6,children:(0,x.jsx)(m.Z,{name:"attributeValue".concat(t),label:"Attribute Value",value:e.attributeValue,required:!0,isFormInputElement:!0})}),(0,x.jsx)(c.sg,{md:6,children:(0,x.jsx)(m.Z,{name:"count".concat(t),label:"Product Count",value:e.count,required:!0,isFormInputElement:!0})}),(0,x.jsx)(c.sg,{md:6,children:(0,x.jsx)(m.Z,{name:"refNumber".concat(t),label:"Reference Number",value:e.refNumber,required:!0,isFormInputElement:!0})}),(0,x.jsx)(c.sg,{md:6,children:(0,x.jsx)(m.Z,{name:"hsnNumber".concat(t),label:"Hsn Number",value:e.hsnNumber,required:!0,isFormInputElement:!0})}),(0,x.jsx)(c.sg,{md:12,children:(0,x.jsx)(l.Z,{name:"productImage".concat(t),label:"Product Main Image(single pic)",isFormInputElement:!0,required:!0,productVariantIndex:t,acceptedFormat:"image/png, image/jpeg, image/jpg",onChange:Q,value:e.pictureUrl?"http://localhost:8085/api/"+e.pictureUrl:"",deleteFile:W,progress:e.productMainImageProgress})})]},t)}))]})]}),(0,x.jsxs)("p",{className:"link-text",onClick:function(){B([].concat((0,u.Z)(R),[{productName:"",attributeValue:"",count:"",pictureUrl:"",productMainImageProgress:0,refNumber:"",hsnNumber:""}]))},children:[(0,x.jsx)(p.f8n,{})," Add Another Product"]}),(0,x.jsx)(c.Bo,{children:(0,x.jsxs)("div",{children:[(0,x.jsx)(c.ux,{style:{marginRight:12},children:"Cancel"}),(0,x.jsx)(c.un,{disabled:!1,onClick:function(){var e;return null===(e=D.current)||void 0===e?void 0:e.handleSubmit()},children:"Submit"})]})})]})})]})}}}]);
//# sourceMappingURL=7905.9192580a.chunk.js.map